# 卡尔曼滤波器调参指南

## WeightKalmanFilter 参数调整指南

### 构造函数参数
```cpp
WeightKalmanFilter(sigma_a, sigma_j, R_sensor_noise)
```

#### sigma_a (过程噪声标准差 for 速度)
- 范围：0.001-0.05
- 较小值(0.001-0.005)：速度估计非常平滑，但对真实速度变化响应较慢，适合稳定流速场景
- 中等值(0.005-0.02)：平衡了平滑性和响应性，适合大多数场景
- 较大值(0.02-0.05)：对速度变化响应快，但可能引入更多噪声，适合流速频繁变化场景

#### sigma_j (过程噪声标准差 for 加速度)
- 范围：1e-7 到 1e-5
- 较小值：加速度估计更平滑
- 较大值：对加速度变化响应更快

#### R_sensor_noise (测量噪声方差 for 重量)
- 若原始重量读数标准差为s，则R约为s*s
- 较小值(0.1-0.5)：更信任传感器读数，适合高精度传感器或稳定环境
- 中等值(0.5-2.0)：适合一般场景下的传感器
- 较大值(2.0-10.0)：传感器噪声大或存在频繁尖峰时使用，减少异常值影响

## DripKalmanFilter 参数调整指南

### 构造函数参数
```cpp
DripKalmanFilter(drip_rate_sigma_a, drip_rate_R, wpd_Q, wpd_R)
```

#### drip_rate_sigma_a (滴速变化加速度标准差)
- 范围：0.01-0.2
- 较小值(0.01-0.05)：滴速估计更平滑，适合稳定滴速场景
- 中等值(0.05-0.1)：平衡了平滑性和响应性
- 较大值(0.1-0.2)：对滴速变化响应更快，适合滴速频繁变化场景

#### drip_rate_R (滴速测量方差)
- 范围：1.0-10.0
- 较小值(1.0-2.0)：更信任原始滴速计算，适合稳定的滴速传感器
- 中等值(2.0-5.0)：适合一般场景
- 较大值(5.0-10.0)：滴速传感器不稳定或存在误触发时使用

#### wpd_Q (WPD过程噪声方差)
- 范围：0.000001-0.0001
- 通常应设置很小(0.000001-0.00001)，因为每滴重量理论上应相对稳定
- 中等值(0.00001-0.00005)：适合大多数场景
- 较大值(0.00005-0.0001)：使WPD校准更快适应变化，但可能引入不稳定性

#### wpd_R (WPD测量噪声方差)
- 范围：0.00001-0.001
- 较小值(0.00001-0.0001)：更信任单次校准测量
- 中等值(0.0001-0.0005)：适合大多数场景
- 较大值(0.0005-0.001)：减少单次异常测量的影响，校准过程更平滑

## DataFusion 参数调整指南

### 构造函数参数
```cpp
DataFusion(q_flow, r_weight_flow, r_drip_flow, q_weight, r_weight_weight, r_drip_weight)
```

#### q_flow (流速过程噪声方差)
- 范围：0.00001-0.001
- 较小值(0.00001-0.0001)：融合后流速更平滑，但对真实变化响应慢
- 中等值(0.0001-0.0005)：适合大多数场景
- 较大值(0.0005-0.001)：对流速变化响应更快，但可能保留更多噪声

#### r_weight_flow/r_drip_flow (流速测量噪声方差)
- 范围：0.001-0.01
- 这两个参数的相对大小决定了对两种传感器的信任度
- 若r_weight_flow < r_drip_flow：更信任重量传感器的流速测量
- 若r_weight_flow > r_drip_flow：更信任滴速传感器的流速测量
- 若两者相等：平等对待两种传感器的测量

#### q_weight (重量过程噪声方差)
- 范围：0.001-0.1
- 较小值(0.001-0.01)：融合后重量估计更平滑，适合稳定场景
- 中等值(0.01-0.05)：适合大多数场景
- 较大值(0.05-0.1)：对重量变化响应更快，适合重量快速变化场景

#### r_weight_weight/r_drip_weight (重量测量噪声方差)
- 范围：0.1-10.0
- 这两个参数的相对大小决定了对两种传感器重量估计的信任度
- 通常r_weight_weight(0.5-2.0) < r_drip_weight(1.0-5.0)，因为重量传感器直接测量重量，而滴速传感器是间接估计 